<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>[Sum]blavaan_BSEM_via_parameter_expansion</title><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; tab-size: 4; background-position: inherit inherit; background-repeat: inherit inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 40px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror-linenumber { }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit inherit; background-repeat: inherit inherit; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; background-position: 0px 0px; background-repeat: initial initial; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print { 
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 32px; padding-right: 32px; padding-bottom: 0px; break-after: avoid; }
  .typora-export #write::after { height: 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; overflow-x: hidden; background-position: initial initial; background-repeat: initial initial; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background-color: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; background-position: initial initial; background-repeat: initial initial; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; }
a.md-print-anchor { white-space: pre !important; border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; text-shadow: initial !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
svg[id^="mermaidChart"] { line-height: 1em; }
mark { background-color: rgb(255, 255, 0); color: rgb(0, 0, 0); background-position: initial initial; background-repeat: initial initial; }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
mark .md-meta { color: rgb(0, 0, 0); opacity: 0.3 !important; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; white-space: nowrap; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; border: none !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; border-width: 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; background-position: 0px 0px; background-repeat: initial initial; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-style: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-style: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background-color: rgba(255, 255, 0, 0.4); background-position: initial initial; background-repeat: initial initial; }
@media print { 
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


html {
	font-size: 19px;
}

html, body {
	margin: auto;
	background: #fefefe;
}
body {
	font-family: "Vollkorn", Palatino, Times;
	color: #333;
	line-height: 1.4;
	text-align: justify;
}

#write {
	max-width: 960px;
	margin: 0 auto;
	margin-bottom: 2em;
	line-height: 1.53;
	padding-top: 40px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1100px;
	}
}

/* Typography
-------------------------------------------------------- */

#write>h1:first-child,
h1 {
	margin-top: 1.6em;
	font-weight: normal;
}

h1 {
	font-size:3em;
}

h2 {
	margin-top:2em;
	font-weight: normal;
}

h3 {
	font-weight: normal;
	font-style: italic;
	margin-top: 3em;
}

h1, 
h2, 
h3{
	text-align: center;
}

h2:after{
	border-bottom: 1px solid #2f2f2f;
    content: '';
    width: 100px;
    display: block;
    margin: 0 auto;
    height: 1px;
}

h1+h2, h2+h3 {
	margin-top: 0.83em;
}

p,
.mathjax-block {
	margin-top: 0;
	-webkit-hypens: auto;
	-moz-hypens: auto;
	hyphens: auto;
}
ul {
	list-style: square;
	padding-left: 1.2em;
}
ol {
	padding-left: 1.2em;
}
blockquote {
	margin-left: 1em;
	padding-left: 1em;
	border-left: 1px solid #ddd;
}
code,
pre {
	font-family: "Consolas", "Menlo", "Monaco", monospace, serif;
	font-size: .9em;
	background: white;
}
.md-fences{
	margin-left: 1em;
	padding-left: 1em;
	border: 1px solid #ddd;
	padding-bottom: 8px;
	padding-top: 6px;
	margin-bottom: 1.5em;
}

a {
	color: #2484c1;
	text-decoration: none;
}
a:hover {
	text-decoration: underline;
}
a img {
	border: none;
}
h1 a,
h1 a:hover {
	color: #333;
	text-decoration: none;
}
hr {
	color: #ddd;
	height: 1px;
	margin: 2em 0;
	border-top: solid 1px #ddd;
	border-bottom: none;
	border-left: 0;
	border-right: 0;
}
.ty-table-edit {
	background: #ededed;
    padding-top: 4px;
}
table {
	margin-bottom: 1.333333rem
}
table th,
table td {
	padding: 8px;
	line-height: 1.333333rem;
	vertical-align: top;
	border-top: 1px solid #ddd
}
table th {
	font-weight: bold
}
table thead th {
	vertical-align: bottom
}
table caption+thead tr:first-child th,
table caption+thead tr:first-child td,
table colgroup+thead tr:first-child th,
table colgroup+thead tr:first-child td,
table thead:first-child tr:first-child th,
table thead:first-child tr:first-child td {
	border-top: 0
}
table tbody+tbody {
	border-top: 2px solid #ddd
}

.task-list{
	padding:0;
}

.md-task-list-item {
	padding-left: 1.6rem;
}

.md-task-list-item > input:before {
	content: '\221A';
	display: inline-block;
	width: 1.33333333rem;
  	height: 1.6rem;
	vertical-align: middle;
	text-align: center;
	color: #ddd;
	background-color: #fefefe;
}

.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before{
	color: inherit;
}
.md-tag {
	color: inherit;
	font: inherit;
}
#write pre.md-meta-block {
	min-height: 35px;
	padding: 0.5em 1em;
}
#write pre.md-meta-block {
	white-space: pre;
	background: #f8f8f8;
	border: 0px;
	color: #999;
	
	width: 100vw;
	max-width: calc(100% + 60px);
	margin-left: -30px;
	border-left: 30px #f8f8f8 solid;
	border-right: 30px #f8f8f8 solid;

	margin-bottom: 2em;
	margin-top: -1.3333333333333rem;
	padding-top: 26px;
	padding-bottom: 10px;
	line-height: 1.8em;
	font-size: 0.9em;
	font-size: 0.76em;
	padding-left: 0;
}
.md-img-error.md-image>.md-meta{
	vertical-align: bottom;
}
#write>h5.md-focus:before {
	top: 2px;
}

.md-toc {
	margin-top: 40px;
}

.md-toc-content {
	padding-bottom: 20px;
}

.outline-expander:before {
	color: inherit;
	font-size: 14px;
	top: auto;
	content: "\f0da";
	font-family: FontAwesome;
}

.outline-expander:hover:before,
.outline-item-open>.outline-item>.outline-expander:before {
  	content: "\f0d7";
}

/** source code mode */
#typora-source {
	font-family: Courier, monospace;
    color: #6A6A6A;
}

.html-for-mac #typora-sidebar {
    -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, .175);
    box-shadow: 0 6px 12px rgba(0, 0, 0, .175);
}

.cm-s-typora-default .cm-header, 
.cm-s-typora-default .cm-property,
.CodeMirror.cm-s-typora-default div.CodeMirror-cursor {
	color: #428bca;
}

.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
	color: #777777;
}

.typora-node .file-list-item-parent-loc, 
.typora-node .file-list-item-time, 
.typora-node .file-list-item-summary {
	font-family: arial, sans-serif;
}

.md-task-list-item>input {
    margin-left: -1.3em;
    margin-top: calc(1rem - 12px);
}

.md-mathjax-midline {
	background: #fafafa;
}

.md-fences .code-tooltip {
	bottom: -2em !important;
}

.dropdown-menu .divider {
	border-color: #e5e5e5;
}


</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-mac'><h1><a name="blavaan-bayesian-structural-equation-models-via-parameter-expansion" class="md-header-anchor"></a><span>blavaan: Bayesian Structural Equation Models via Parameter Expansion</span></h1><p><span>Merkle, E. C. , &amp; Rosseel, Y. . (2018). blavaan: bayesian structural equation models via parameter expansion. </span><em><span>Journal of statistical software, 85</span></em><span>(4), 1-30.</span></p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n0"><a class="md-toc-inner" style="" href="#blavaan-bayesian-structural-equation-models-via-parameter-expansion">blavaan: Bayesian Structural Equation Models via Parameter Expansion</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n4"><a class="md-toc-inner" style="" href="#blavaan">blavaan</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n8"><a class="md-toc-inner" style="" href="#prior-for-the-disturbance-covariances">Prior for the disturbance covariances</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n30"><a class="md-toc-inner" style="" href="#other-features-of-blavaan">other features of blavaan</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n31"><a class="md-toc-inner" style="" href="#model-fitting-fitmeasures">model fitting: fitMeasures()</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n40"><a class="md-toc-inner" style="" href="#default-priors">default priors</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n43"><a class="md-toc-inner" style="" href="#convergence">convergence</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n48"><a class="md-toc-inner" style="" href="#initial-values">initial values</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n52"><a class="md-toc-inner" style="" href="#modify-the-default-jags-code-and-reestimate-the-model">modify the default jags code and reestimate the model</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n54"><a class="md-toc-inner" style="" href="#measurement-invariance">Measurement invariance</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n56"><a class="md-toc-inner" style="" href="#my-thoughts">My Thoughts</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n57"><a class="md-toc-inner" style="" href="#problem-of-the-parameter-expansion-method">Problem of the parameter expansion method</a></span></p></div><h2><a name="blavaan" class="md-header-anchor"></a><span>blavaan</span></h2><p><span>BSEM based on JAGS and runjags (now also based on stan)</span></p><p><span>other factor analysis samplers: bfa, MCMCpack.    brms</span></p><p><span>If one is restricted to conjugate priors, then the Song and Lee (2012) or Muth ́en and As- parouhov (2012) procedures are often available for simple MCMC estimation of the above model. However, if one wishes to use general priors or to estimate novel models, then there is the choice of implementing a custom MCMC scheme or using a general MCMC program like BUGS, JAGS, or Stan (Stan Development Team 2014). </span></p><h3><a name="prior-for-the-disturbance-covariances" class="md-header-anchor"></a><span>Prior for the disturbance covariances</span></h3><p><span>Lee (2007) assumes that the manifest variable covariance matrix Θ and the endogenous latent variable covariance matrix Ψ are diagonal. </span></p><p>&nbsp;</p><p><span>The background of the propose of parameter expansion method: Correlated residuals pose a difficult problem for MCMC methods because they often result in covariance matrices with some (but not all) off-diagonal entries equal to zero. In this situation, we cannot assign an inverse Wishart prior to the full covariance matrix because this does not allow us to fix some off-diagonal entries to zero. </span></p><p><span>Mplus&#39;s solution the this problem: To address the issue of non-diagonal covariance matrices, Muth ́en and Asparouhov (2012) implemented a random walk method that is based on work by Chib and Greenberg (1998). This method samples free parameters of the covariance matrix via Metropolis-Hastings steps.</span></p><p><span>Mplus&#39;s solution&#39;s problem: While the implementation is fast and efficient, it does not allow for some types of equality constraints because parameters are updated in blocks (either all parameters in a block must be constrained to equality, or no parameters in a block can be constrained).</span></p><p>&nbsp;</p><p><span>parameter expansion method</span></p><p><span>Our approach here is related to that of Palomo et al. (2007), who employ phantom latent variables (they use the term pseudo-latent variable) to simplify the estimation of mod- els with non-diagonal Θ matrices.</span></p><p><img src="fig/200912_1.png" referrerpolicy="no-referrer"></p><p><span>My example JAGS code for the disturbance covariances between three factors</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="{r}" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">######################################################################</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Specify the (prior) distribution for the latent variables</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">######################################################################</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> (<span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">n</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">kappa</span>[<span class="cm-variable">i</span>,<span class="cm-number">1</span>] <span class="cm-operator cm-arrow">&lt;-</span> &nbsp;<span class="cm-variable">mu.f</span>[<span class="cm-number">1</span>] <span class="cm-operator">+</span> <span class="cm-variable">inprod</span>(<span class="cm-variable">dat</span>[<span class="cm-variable">i</span>,(<span class="cm-variable">J</span><span class="cm-operator">+</span><span class="cm-number">1</span>)<span class="cm-operator">:</span>(<span class="cm-variable">J</span><span class="cm-operator">+</span><span class="cm-variable">P</span>)], <span class="cm-variable">beta</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">P</span>,<span class="cm-number">1</span>]) <span class="cm-operator">+</span> <span class="cm-variable">lambda.d</span>[<span class="cm-number">1</span>,<span class="cm-number">2</span>]<span class="cm-operator">*</span><span class="cm-variable">phantom.d</span>[<span class="cm-variable">i</span>,<span class="cm-number">1</span>] <span class="cm-operator">+</span> <span class="cm-variable">lambda.d</span>[<span class="cm-number">1</span>,<span class="cm-number">3</span>]<span class="cm-operator">*</span><span class="cm-variable">phantom.d</span>[<span class="cm-variable">i</span>,<span class="cm-number">3</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">kappa</span>[<span class="cm-variable">i</span>,<span class="cm-number">2</span>] <span class="cm-operator cm-arrow">&lt;-</span> &nbsp;<span class="cm-variable">mu.f</span>[<span class="cm-number">2</span>] <span class="cm-operator">+</span> <span class="cm-variable">inprod</span>(<span class="cm-variable">dat</span>[<span class="cm-variable">i</span>,(<span class="cm-variable">J</span><span class="cm-operator">+</span><span class="cm-number">1</span>)<span class="cm-operator">:</span>(<span class="cm-variable">J</span><span class="cm-operator">+</span><span class="cm-variable">P</span>)], <span class="cm-variable">beta</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">P</span>,<span class="cm-number">2</span>]) <span class="cm-operator">+</span> <span class="cm-variable">lambda.d</span>[<span class="cm-number">2</span>,<span class="cm-number">1</span>]<span class="cm-operator">*</span><span class="cm-variable">phantom.d</span>[<span class="cm-variable">i</span>,<span class="cm-number">1</span>] <span class="cm-operator">+</span> <span class="cm-variable">lambda.d</span>[<span class="cm-number">2</span>,<span class="cm-number">3</span>]<span class="cm-operator">*</span><span class="cm-variable">phantom.d</span>[<span class="cm-variable">i</span>,<span class="cm-number">2</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">kappa</span>[<span class="cm-variable">i</span>,<span class="cm-number">3</span>] <span class="cm-operator cm-arrow">&lt;-</span> &nbsp;<span class="cm-variable">mu.f</span>[<span class="cm-number">3</span>] <span class="cm-operator">+</span> <span class="cm-variable">inprod</span>(<span class="cm-variable">dat</span>[<span class="cm-variable">i</span>,(<span class="cm-variable">J</span><span class="cm-operator">+</span><span class="cm-number">1</span>)<span class="cm-operator">:</span>(<span class="cm-variable">J</span><span class="cm-operator">+</span><span class="cm-variable">P</span>)], <span class="cm-variable">beta</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">P</span>,<span class="cm-number">3</span>]) <span class="cm-operator">+</span> <span class="cm-variable">lambda.d</span>[<span class="cm-number">3</span>,<span class="cm-number">1</span>]<span class="cm-operator">*</span><span class="cm-variable">phantom.d</span>[<span class="cm-variable">i</span>,<span class="cm-number">3</span>] <span class="cm-operator">+</span> <span class="cm-variable">lambda.d</span>[<span class="cm-number">3</span>,<span class="cm-number">2</span>]<span class="cm-operator">*</span><span class="cm-variable">phantom.d</span>[<span class="cm-variable">i</span>,<span class="cm-number">2</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">## phantom.d  1: f1 with f2, 2: f2 with f3, 3: f1 with f3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">phantom.d</span>[<span class="cm-variable">i</span>,<span class="cm-number">1</span>] <span class="cm-operator">~</span> <span class="cm-variable">dnorm</span>(<span class="cm-number">0</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">phantom.d</span>[<span class="cm-variable">i</span>,<span class="cm-number">2</span>] <span class="cm-operator">~</span> <span class="cm-variable">dnorm</span>(<span class="cm-number">0</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">phantom.d</span>[<span class="cm-variable">i</span>,<span class="cm-number">3</span>] <span class="cm-operator">~</span> <span class="cm-variable">dnorm</span>(<span class="cm-number">0</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">for</span> (<span class="cm-variable">z</span> <span class="cm-keyword">in</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">Z</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ksi</span>[<span class="cm-variable">i</span>,<span class="cm-variable">z</span>] <span class="cm-operator">~</span> <span class="cm-variable">dnorm</span>(<span class="cm-variable">kappa</span>[<span class="cm-variable">i</span>,<span class="cm-variable">z</span>], <span class="cm-number">1</span><span class="cm-operator">/</span><span class="cm-variable">psi.star</span>[<span class="cm-variable">z</span>,<span class="cm-variable">z</span>]) &nbsp;<span class="cm-comment"># distribution for the latent variables</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">psi.star</span>[<span class="cm-number">1</span>,<span class="cm-number">1</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">psi</span>[<span class="cm-number">1</span>,<span class="cm-number">1</span>] <span class="cm-operator">-</span> <span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">1</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">1</span>,<span class="cm-number">1</span>] <span class="cm-operator">-</span> <span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">3</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">1</span>,<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">psi.star</span>[<span class="cm-number">2</span>,<span class="cm-number">2</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">psi</span>[<span class="cm-number">2</span>,<span class="cm-number">2</span>] <span class="cm-operator">-</span> <span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">1</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">2</span>,<span class="cm-number">2</span>] <span class="cm-operator">-</span> <span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">2</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">2</span>,<span class="cm-number">2</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">psi.star</span>[<span class="cm-number">3</span>,<span class="cm-number">3</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">psi</span>[<span class="cm-number">3</span>,<span class="cm-number">3</span>] <span class="cm-operator">-</span> <span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">2</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">3</span>,<span class="cm-number">3</span>] <span class="cm-operator">-</span> <span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">3</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">3</span>,<span class="cm-number">3</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#psi.star[2,2] &lt;- psi[2,2] - ((-1 + 2*step(rho[1]))*sqrt(abs(rho[1])*psi[2,2]))^2 - (sqrt(abs(rho[2])*psi[2,2]))^2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#psi.star[3,3] &lt;- psi[3,3] - ((-1 + 2*step(rho[2]))*sqrt(abs(rho[2])*psi[3,3]))^2 - ((-1 + 2*step(rho[3]))*sqrt(abs(rho[3])*psi[3,3]))^2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lambda.d</span>[<span class="cm-number">1</span>,<span class="cm-number">2</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sqrt</span>(<span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">1</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">1</span>,<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lambda.d</span>[<span class="cm-number">2</span>,<span class="cm-number">1</span>] <span class="cm-operator cm-arrow">&lt;-</span> (<span class="cm-operator">-</span><span class="cm-number">1</span> <span class="cm-operator">+</span> <span class="cm-number">2</span><span class="cm-operator">*</span><span class="cm-variable">step</span>(<span class="cm-variable">rho</span>[<span class="cm-number">1</span>]))<span class="cm-operator">*</span><span class="cm-variable">sqrt</span>(<span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">1</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">2</span>,<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lambda.d</span>[<span class="cm-number">1</span>,<span class="cm-number">3</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sqrt</span>(<span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">3</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">1</span>,<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lambda.d</span>[<span class="cm-number">3</span>,<span class="cm-number">1</span>] <span class="cm-operator cm-arrow">&lt;-</span> (<span class="cm-operator">-</span><span class="cm-number">1</span> <span class="cm-operator">+</span> <span class="cm-number">2</span><span class="cm-operator">*</span><span class="cm-variable">step</span>(<span class="cm-variable">rho</span>[<span class="cm-number">3</span>]))<span class="cm-operator">*</span><span class="cm-variable">sqrt</span>(<span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">3</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">3</span>,<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lambda.d</span>[<span class="cm-number">2</span>,<span class="cm-number">3</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sqrt</span>(<span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">2</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">2</span>,<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lambda.d</span>[<span class="cm-number">3</span>,<span class="cm-number">2</span>] <span class="cm-operator cm-arrow">&lt;-</span> (<span class="cm-operator">-</span><span class="cm-number">1</span> <span class="cm-operator">+</span> <span class="cm-number">2</span><span class="cm-operator">*</span><span class="cm-variable">step</span>(<span class="cm-variable">rho</span>[<span class="cm-number">2</span>]))<span class="cm-operator">*</span><span class="cm-variable">sqrt</span>(<span class="cm-variable">abs</span>(<span class="cm-variable">rho</span>[<span class="cm-number">2</span>])<span class="cm-operator">*</span><span class="cm-variable">psi</span>[<span class="cm-number">3</span>,<span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> (<span class="cm-variable">z</span> <span class="cm-keyword">in</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">Z</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">psi</span>[<span class="cm-variable">z</span>,<span class="cm-variable">z</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-number">1</span><span class="cm-operator">/</span><span class="cm-variable">inv.psi</span>[<span class="cm-variable">z</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">inv.psi</span>[<span class="cm-variable">z</span>] <span class="cm-operator">~</span> <span class="cm-variable">dgamma</span>(<span class="cm-number">1</span>, <span class="cm-number">0.5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## assign a beta distribution with support on (-1, 1) instead of the default (0, 1)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rho</span>[<span class="cm-variable">z</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-operator">-</span><span class="cm-number">1</span> <span class="cm-operator">+</span> <span class="cm-number">2</span><span class="cm-operator">*</span><span class="cm-variable">rho.new</span>[<span class="cm-variable">z</span>] </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rho.new</span>[<span class="cm-variable">z</span>] <span class="cm-operator">~</span> <span class="cm-variable">dbeta</span>(<span class="cm-number">1</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mu.f</span>[<span class="cm-variable">z</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Inferential covariances</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">psi</span>[<span class="cm-number">1</span>,<span class="cm-number">2</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">lambda.d</span>[<span class="cm-number">1</span>,<span class="cm-number">2</span>]<span class="cm-operator">*</span><span class="cm-variable">lambda.d</span>[<span class="cm-number">2</span>,<span class="cm-number">1</span>]<span class="cm-operator">*</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">psi</span>[<span class="cm-number">1</span>,<span class="cm-number">3</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">lambda.d</span>[<span class="cm-number">1</span>,<span class="cm-number">3</span>]<span class="cm-operator">*</span><span class="cm-variable">lambda.d</span>[<span class="cm-number">3</span>,<span class="cm-number">1</span>]<span class="cm-operator">*</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">psi</span>[<span class="cm-number">2</span>,<span class="cm-number">3</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">lambda.d</span>[<span class="cm-number">2</span>,<span class="cm-number">3</span>]<span class="cm-operator">*</span><span class="cm-variable">lambda.d</span>[<span class="cm-number">3</span>,<span class="cm-number">2</span>]<span class="cm-operator">*</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">d</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">Z</span><span class="cm-operator">+</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">Z</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1612px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1612px;"></div></div></div></pre><p>&nbsp;</p><p><span>this method can only be realized in JAGS (the previous default setting of blavaan-2018), the following method can also be realized in stan (the current default setting-2020)</span></p><p><img src="fig/200912_2.png" referrerpolicy="no-referrer"></p><p>&nbsp;</p><p><span>The main disadvantage of the &quot;fa&quot; approach is that the implied prior distributions on the inferential model parameters are not of a common form. Thus, it is difficult to introduce informative prior distributions for the inferential model variance/covariance parameters. For example, the prior on the inferential covariance (θ12) is the product of two normal prior dis- tributions and an inverse gamma, which can be surprisingly informative. To avoid confusion here, we do not allow the user to directly modify the priors on the working parameters λ1, λ2, and ψD under the &quot;fa&quot; approach. </span></p><p><span>While we prefer the &quot;srs&quot; approach to covariances between observed variables, the &quot;fa&quot; approach may be useful for complex models that run slowly. </span></p><p>&nbsp;</p><p>&nbsp;</p><p><span>Beyond these options, the package attempts to identify when it can sample latent variables directly from a multivariate normal distribution, which can improve sampling efficiency. This most commonly happens when we have many exogenous latent variables that all covary with one another. In this case, we place an inverse Wishart prior distribution on the latent variable covariance matrix.</span></p><p><span>(But I didn&#39;t see it happens even when I estimate the whole factor variance-covarnace matrix..)</span></p><h3><a name="other-features-of-blavaan" class="md-header-anchor"></a><span>other features of blavaan</span></h3><h4><a name="model-fitting-fitmeasures" class="md-header-anchor"></a><span>model fitting: fitMeasures()</span></h4><ul><li><span>posterior predictive checks of the model’s log-likelihood (e.g., Gelman, Carlin, Stern, and Rubin 2004).</span></li><li><span>the Deviance Information Criterion (DIC; Spiegelhalter, Best, Carlin, and Linde 2002), the (Laplace-approximated) log-Bayes factor, the Widely Applicable Information Criterion (WAIC; Watanabe 2010), and the leave-one-out cross-validation statistic (LOO; e.g., Gelfand 1996).</span></li></ul><p><span>blavaan calculates the likelihood separately after parameters have been sampled in JAGS.</span></p><p><span>The latter two statistics are computed by R package loo (Vehtari, Gelman, and Gabry 2015b), using output from blavaan.</span></p><p>&nbsp;</p><h4><a name="default-priors" class="md-header-anchor"></a><span>default priors</span></h4><p><img src="fig/200912_3.png" referrerpolicy="no-referrer"></p><p>&nbsp;</p><h4><a name="convergence" class="md-header-anchor"></a><span>convergence</span></h4><p><span>Package blavaan offers two methods for monitoring chain convergence, specified as the &quot;auto&quot; or &quot;manual&quot; options to the convergence argument. </span></p><p><span>Under &quot;auto&quot; convergence, chains are sampled for an initial period in order to (i) achieve convergence as determined by the Potential Scale Reduction Factor (PSRF; Gelman and Rubin 1992) and (ii) determine the number of samples necessary to obtain precise posterior estimates.  based on the autorun.jags() function</span></p><p><span>Under &quot;manual&quot; convergence, the user can specify the desired number of adaptation, burnin, and sample iterations via arguments of the same name (with defaults of 1,000 adaptation iterations, 4,000 burnin iterations, and 10,000 sample iterations).</span></p><p>&nbsp;</p><h4><a name="initial-values" class="md-header-anchor"></a><span>initial values</span></h4><p><span>The initial values of a fitted model can be obtained via blavInspect(); i.e.,</span></p><p><span>&gt;</span><span> myinits &lt;- blavInspect(fit, &quot;inits&quot;)</span></p><p>&nbsp;</p><h4><a name="modify-the-default-jags-code-and-reestimate-the-model" class="md-header-anchor"></a><span>modify the default jags code and reestimate the model</span></h4><p><img src="fig/200912_4.png" referrerpolicy="no-referrer"></p><h3><a name="measurement-invariance" class="md-header-anchor"></a><span>Measurement invariance</span></h3><p><img src="fig/200912_4.png" referrerpolicy="no-referrer"></p><h2><a name="my-thoughts" class="md-header-anchor"></a><span>My Thoughts</span></h2><h4><a name="problem-of-the-parameter-expansion-method" class="md-header-anchor"></a><span>Problem of the parameter expansion method</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="{r}" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">My</span> <span class="cm-string">"I have read your paper "</span><span class="cm-variable">blavaan</span><span class="cm-operator">:</span> <span class="cm-variable">Bayesian</span> <span class="cm-variable">SEM</span> <span class="cm-variable">via</span> <span class="cm-variable">parameter</span> <span class="cm-variable">expansion</span><span class="cm-string">"</span> <span class="cm-string">and the proposed method attracts me. However, I am wondering what would happen if the sum of </span><span class="cm-string-2">\r</span><span class="cm-string">ho larger than one (since </span><span class="cm-string-2">\p</span><span class="cm-string">si* = </span><span class="cm-string-2">\p</span><span class="cm-string">si(1- sum(</span><span class="cm-string-2">\r</span><span class="cm-string">ho)), under this condition, the </span><span class="cm-string-2">\p</span><span class="cm-string">si* would be negative)? For example, for a MIMIC model with disturbance covariances among three factors are larger than 0.5."</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Dr.</span> <span class="cm-variable">Merkle</span> <span class="cm-string">"You are right that this parameter expansion approach does not work for all models. In case psi* is negative, then JAGS will crash. For example:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">library(blavaan)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">HS.model &lt;- ' visual  =~ x1 + x2 + x3 + x4</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">x1 ~~ .35*x2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">x1 ~~ .35*x3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">x1 ~~ .35*x4 '</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">## error:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">m1 &lt;- bsem(HS.model, data=HolzingerSwineford1939, target='jags')</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">I don't see that happen in many models, but it is possible. The new default, target="</span><span class="cm-variable">stan</span><span class="cm-string">", does not use parameter expansion and would work:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">m1 &lt;- bsem(HS.model, data=HolzingerSwineford1939, burnin=100, sample=100, target='stan')</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">But there is still a problem with the prior distributions for the covariance matrix there. That covariance matrix is decomposed into correlations and standard deviations. Then each standard deviation gets a gamma prior, and each free correlation gets a beta prior. But that combination of priors can lead to non-positive definite covariance matrices, so we have to qualify the prior distributions by "</span><span class="cm-variable">subject</span> <span class="cm-variable">to</span> <span class="cm-variable">the</span> <span class="cm-variable">resulting</span> <span class="cm-variable">covariance</span> <span class="cm-variable">matrix</span> <span class="cm-variable">being</span> <span class="cm-variable">positive</span> <span class="cm-variable">definite</span><span class="cm-string">".</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">It is easy to use inverse wishart or lkj on a covariance matrix with all free parameters, but tricky to handle a covariance matrix with some fixed 0s. For example, imagine the model above, but the parameters fixed to .35 are free:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">blavInspect(m1, "</span><span class="cm-variable">est</span><span class="cm-string">")$theta</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">I am trying to find a user-friendly solution here (maybe something related to lkj) and would be happy to hear any ideas.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">My</span> <span class="cm-string">"I am wondering maybe the problem of the parameter expansion method is caused by the non-zero correlation between the high-level factors, that is, phantom variables. Taking the HS.model as an example, phantom variable d12 which is correlated with x1 maybe also correlated with d13. In this way, the untennable orthogonal hypothesis of phantom variables when calculating the psi* can result in the negative psi*."</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Dr.</span> <span class="cm-variable">Merkle</span> <span class="cm-string">"Yes, that might help: if we allow phantom variables to be correlated, perhaps we can avoid negative psi*. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">The tricky question is then how to choose a prior for the phantom variable correlations/covariances. Most blavaan users wouldn't be able to specify those priors, because they don't understand phantom latent variables and how the phantom variables are related to their desired model. This is why I defined the "</span><span class="cm-variable">psi</span><span class="cm-operator">*</span><span class="cm-string">"</span> <span class="cm-string">variable the way that I did, so that users only had to specify priors for the original model parameters. But there might be a better way to do this.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1586px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1586px;"></div></div></div></pre><p>&nbsp;</p><p>&nbsp;</p><center>
<ul class="actions">
<li><a href="https://www.lijinzhang.xyz/blog_200520_summary.html" class="button">Return</a></li>
</ul>			
</center></div>
</body>
</html>